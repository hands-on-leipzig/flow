<IfModule mod_rewrite.c>
    RewriteEngine On

    # üîí Force HTTPS
    RewriteCond %{HTTPS} !=on
    RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

    # üåê Prevent directory listing and MultiViews
    Options -MultiViews -Indexes

    # üõ† Authorization headers
    RewriteCond %{HTTP:Authorization} .
    RewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]

    # ‚ö†Ô∏è Do not redirect real files or dirs
    RewriteCond %{REQUEST_FILENAME} -f [OR]
    RewriteCond %{REQUEST_FILENAME} -d
    RewriteRule ^ - [L]

    # üö´ Exclude output dir from Laravel/Vue routing
    RewriteCond %{REQUEST_URI} ^/output/
    RewriteRule ^ - [L]

    # üéØ Event slug routing - redirect to slug handler
    # Pattern: /slug -> /slug-handler.php?slug=slug
    RewriteCond %{REQUEST_URI} !^/(api|sanctum|login|logout|password|output|legacy)/
    RewriteCond %{REQUEST_URI} ^/([a-zA-Z0-9_-]+)/?$
    RewriteRule ^([a-zA-Z0-9_-]+)/?$ /slug-handler.php?slug=$1 [L,QSA]

    # ‚úÖ Laravel handles API routes
    RewriteCond %{REQUEST_URI} ^/api
    RewriteRule ^ index.php [L]

    # ‚úÖ Laravel fallback (e.g. auth, POST endpoints)
    RewriteCond %{REQUEST_URI} ^/sanctum [OR]
    RewriteCond %{REQUEST_URI} ^/login [OR]
    RewriteCond %{REQUEST_URI} ^/logout [OR]
    RewriteCond %{REQUEST_URI} ^/password
    RewriteRule ^ index.php [L]

    # üîÅ Vue SPA fallback ‚Äî everything else goes to frontend
    RewriteRule ^ index.html [L]
</IfModule>
